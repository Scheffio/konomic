import{i as d,f as l,h as i}from"./index-YqKFqo25.js";const S=d("Logs",()=>{const t=l([]),s=localStorage.getItem("logs");return s&&(t.value=JSON.parse(s)._value),i(()=>t,r=>{localStorage.setItem("logs",JSON.stringify(r))},{deep:!0}),{logs:t,addToLogs:r=>{t.value.push({...r})}}}),v=d("OrderBook",()=>{const t=l([]);let s=l(100);const a=l("BTCUSDT"),r=localStorage.getItem("orders"),m=S(),n=l(),f={day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"};localStorage.getItem("default-pair")||localStorage.setItem("default-pair","BTCUSDT"),a.value=localStorage.getItem("default-pair"),r&&(t.value=JSON.parse(r)._value),i(()=>t,o=>{localStorage.setItem("orders",JSON.stringify(o))},{deep:!0}),i(a,(o,e)=>{m.addToLogs({from:e,to:o,time:new Date().toLocaleDateString("ru-RU",f)}),localStorage.setItem("default-pair",o)});const u=o=>{t.value=o,console.log(o)};i(a,()=>{n.value&&n.value.close(),n.value=new WebSocket(`wss://stream.binance.com:9443/ws/${a.value.toLowerCase()}@depth`),n.value.onmessage=function(o){const e=JSON.parse(o.data);e.a.forEach(c=>{t.value.asks.unshift(c)}),e.b.forEach(c=>{t.value.bids.unshift(c)})}});const g=()=>{const o=`https://api.binance.com/api/v3/depth?symbol=${a.value}&limit=${s.value}`;fetch(o).then(e=>{if(!e.ok)throw new Error(`Ошибка HTTP! Статус: ${e.status}`);return e.json()}).then(e=>{u(e)}).catch(e=>{console.error("Ошибка: ",e.message,e.stack)})};return i([s,a],()=>{g()},{immediate:!0}),{orders:t,addToOrderBook:u,tableLimit:s,getOrderBook:g,pair:a}});export{v as a,S as u};
