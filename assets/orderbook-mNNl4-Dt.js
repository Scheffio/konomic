import{i as p,f as r,h as d,j as T}from"./index-hypwxGr7.js";const I=p("Logs",()=>{const e=r([]),o=localStorage.getItem("logs");return o&&(e.value=JSON.parse(o)._value),d(()=>e,l=>{localStorage.setItem("logs",JSON.stringify(l))},{deep:!0}),{logs:e,addToLogs:l=>{e.value.push({...l})}}}),b=p("OrderBook",()=>{const e=r([]),o=r([]);let c=r(100),l=T(()=>c.value+c.value/2);const i=r("BTCUSDT"),h=I(),n=r(),S={day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"};localStorage.getItem("default-pair")||localStorage.setItem("default-pair","BTCUSDT"),i.value=localStorage.getItem("default-pair"),d(i,(s,t)=>{h.addToLogs({from:t,to:s,time:new Date().toLocaleDateString("ru-RU",S)}),localStorage.setItem("default-pair",s)});const v=s=>{e.value=s.asks,o.value=s.bids},f=()=>{n.value&&n.value.close(),n.value=new WebSocket(`wss://stream.binance.com:9443/ws/${i.value.toLowerCase()}@depth`),n.value.onmessage=function(s){const t=JSON.parse(s.data);t.a.forEach(a=>{e.value.length>l.value&&e.value.splice(l.value);let u=e.value.findIndex(g=>g[0]==a[0]);u>=0?a[1]==0?e.value.splice(u,1):e.value[u][1]=a[1]:a[1]!=0&&e.value.unshift(a)}),t.b.forEach(a=>{o.valuelength>l.value&&o.value.splice(l.value);let u=o.value.findIndex(g=>g[0]==a[0]);u>=0?a[1]==0?o.value.splice(u,1):o.value[u][1]=a[1]:a[1]!=0&&e.value.unshift(a)})}};d(i,()=>{f()},{immediate:!0});const m=()=>{const s=`https://api.binance.com/api/v3/depth?symbol=${i.value}&limit=${l.value}`;fetch(s).then(t=>{if(!t.ok)throw new Error(`Ошибка HTTP! Статус: ${t.status}`);return t.json()}).then(t=>{v(t)}).catch(t=>{console.error("Ошибка: ",t.message,t.stack)})};return d([c,i],()=>{m()},{immediate:!0}),{asks:e,bids:o,addToOrderBook:v,tableLimit:c,getOrderBook:m,pair:i,setCurrencyGlassSocket:f}});export{b as a,I as u};
